<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>Картинка</title>
</head>
<body>
	<img src="img.png" alt="" id="img" height="auto" width="500">
	<canvas id="cvs" height="auto" width="500"></canvas>

	<script>
		
		document.getElementById('img').onload = function()
		{
			var canvas = document.getElementById('cvs');
			var ctx = canvas.getContext('2d');
			var img = document.getElementById('img')
			ctx.drawImage(this, 0, 0);
			img.crossOrigin = "Anonymous";
			var imageData = ctx.getImageData(0,0,img.width,img.height);
		

		// var canvas = document.getElementById('cvs');
		// var ctx = canvas.getContext('2d');

		// var img = new Image();
	 //    img.onload = function() 
	 //    {
	 //    	ctx.drawImage(this, 0, 0);
	 //    }
	 //    img.crossOrigin = "Anonymous";
		// img.src = document.getElementById('img').src;
	
		// var Img  = document.getElementById('img');
		// blur(Img);
		

		// function blur(img)
		// {
		// 	var canvas = document.getElementById('cvs');
		// 	var obj = canvas.getContext('2d');

		// 	var imageData = obj.getImageData(0,0,img.width,img.height);

			for(let i = 1; i < img.width-1;i++)
			{
				for(let j = 1; j < img.height-1;j++)
				{
					var red, green, blue, alpha;
					var pixels = obj.getImageData(i-1,j-1,3,3);

					for(k = 0; k < pixels.data.length; k+=4)
					{
						red = pixels.data[k];
						green = pixels.data[k+1];
						blue = pixels.data[k+2];
						alpha = pixels.data[k+3];
					}
					imageData.data[(i*img.width+j)*4] = Math.floor(red/9);
					imageData.data[(i*img.width+j + 1)*4] = Math.floor(green/9);
					imageData.data[(i*img.width+j + 2)*4] = Math.floor(blue/9);
					imageData.data[(i*img.width+j + 3)*4] = Math.floor(alpha/9);
				}
			}
			obj.putImageData(imageData,0,0);
		}
		
	</script>
</body>
</html>
